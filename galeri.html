<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeri - Sebuah Kejutan Untukmu</title>

    <!-- TEMPEL KODE IKON DI SINI -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M20,80 h60 v-15 h-60 z' fill='%23E6A4B4'/><path d='M25,65 h50 v-15 h-50 z' fill='%23F3D7CA'/><path d='M30,50 h40 v-15 h-40 z' fill='%23E6A4B4'/><path d='M47,35 h6 v10 h-6 z' fill='white'/><path d='M48,25 a3,5 0 1,0 4,0 l-2,-10 z' fill='orange'/></svg>">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FFF8F0;
            --text-color: #4A4A4A;
            --primary-color: #E6A4B4;
            --secondary-color: #F3D7CA;
            --accent-color: #C17C74;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .nav-link.active {
            color: var(--primary-color);
            font-weight: 700;
        }
        .gemini-btn .spinner {
            display: none;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .gemini-btn.loading .spinner { display: block; }
        .gemini-btn.loading .btn-text { display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <header id="navbar" class="bg-white/70 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-3">
            <nav class="flex justify-center items-center space-x-4 md:space-x-8">
                <a href="index.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">Let's Celebrate</a>
                <a href="galeri.html" class="nav-link active text-sm md:text-base font-semibold hover:text-pink-500 transition-colors">Galeri Kenangan</a>
                <a href="challenge.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">Challenge</a>
                <a href="for-me.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">For Me</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-6 py-16">
        <section id="galeri" class="text-center">
            <h2 class="text-3xl font-bold mb-2">Galeri Kenangan</h2>
            <p class="text-gray-600 mb-8">Satu tahun ke belakang dalam beberapa potret.</p>
            <div class="mb-8">
                <button id="generate-story-btn" class="gemini-btn bg-white text-pink-500 border border-pink-500 font-bold py-2 px-6 rounded-full hover:bg-pink-500 hover:text-white transition-colors shadow-lg flex items-center justify-center mx-auto space-x-2">
                    <span class="btn-text">âœ¨ Ceritakan Kenangan Kita</span>
                    <div class="spinner"></div>
                </button>
            </div>
            <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Bantuan: Ganti '#' dengan URL gambar Anda dan teks deskripsi di atribut alt="" -->
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/E6A4B4/4A4A4A?text=FOTO+1" alt="Hari pertama kita jalan di taman kota." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/F3D7CA/4A4A4A?text=FOTO+2" alt="Mencoba es krim viral yang ternyata sangat manis." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/C17C74/FFFFFF?text=FOTO+3" alt="Nonton konser musik indie sampai larut malam." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/E6A4B4/4A4A4A?text=FOTO+4" alt="Perjalanan spontan kita ke puncak." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/F3D7CA/4A4A4A?text=FOTO+5" alt="Memasak makan malam bersama untuk pertama kalinya." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                <div class="gallery-item cursor-pointer group aspect-square">
                    <img src="https://placehold.co/600x600/C17C74/FFFFFF?text=FOTO+6" alt="Merayakan anniversary kecil kita di kafe favorit." class="w-full h-full object-cover rounded-lg shadow-md transform group-hover:scale-105 transition-transform duration-300">
                </div>
                 <!-- Tambahkan lebih banyak item galeri di sini -->
            </div>
        </section>
    </main>

    <div id="gallery-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden flex items-center justify-center p-4">
        <div class="relative"><img id="modal-img" src="" alt="Gambar Diperbesar" class="max-w-[90vw] max-h-[90vh] rounded-lg shadow-2xl"><button id="close-modal" class="absolute -top-4 -right-4 w-10 h-10 text-white bg-pink-500 rounded-full text-2xl">&times;</button></div>
    </div>
    
    <div id="notification-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 text-center max-w-sm mx-auto"><h3 id="notification-title" class="text-xl font-bold mb-4">Notifikasi</h3><div id="notification-message" class="text-base mb-6 text-left max-h-[60vh] overflow-y-auto"></div><button id="close-notification" class="bg-pink-500 text-white font-bold py-2 px-6 rounded-full hover:bg-pink-600 transition-colors">Tutup</button></div>
    </div>

    <div class="fixed bottom-4 right-4 z-40">
        <audio id="background-music" src="/assets/audio/hbdsong.mp3" loop></audio>
        <button id="music-control" class="w-12 h-12 bg-white/80 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg text-pink-500 hover:text-pink-700 transition-colors"><svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></button>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Music Player Logic
    const music = document.getElementById('background-music');
    const musicControl = document.getElementById('music-control');
    const playIcon = document.getElementById('play-icon');
    const pauseIcon = document.getElementById('pause-icon');
    let hasInteracted = false;
    
    function playMusic() {
        music.play().then(() => {
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        }).catch(error => console.log("Autoplay ditolak."));
    }

    document.body.addEventListener('click', () => {
        if (!hasInteracted) {
            playMusic();
            hasInteracted = true;
        }
    }, { once: true });
    
    musicControl.addEventListener('click', () => { music.paused ? playMusic() : (music.pause(), playIcon.classList.remove('hidden'), pauseIcon.classList.add('hidden')); });

    // Gallery Modal Logic
    const galleryModal = document.getElementById('gallery-modal');
    const modalImg = document.getElementById('modal-img');
    const closeModalBtn = document.getElementById('close-modal');
    document.querySelectorAll('.gallery-item').forEach(item => {
        item.addEventListener('click', function() {
            const imgSrc = this.querySelector('img').src;
            modalImg.src = imgSrc;
            galleryModal.classList.remove('hidden');
            galleryModal.classList.add('flex');
        });
    });
    closeModalBtn.addEventListener('click', () => {
        galleryModal.classList.add('hidden');
        galleryModal.classList.remove('flex');
    });

    // Gemini API Integration
    const notificationModal = document.getElementById('notification-modal');
    const notificationTitle = document.getElementById('notification-title');
    const notificationMessage = document.getElementById('notification-message');
    const closeNotificationBtn = document.getElementById('close-notification');

    function showNotification(message, title = "Notifikasi") {
        notificationTitle.textContent = title;
        notificationMessage.innerHTML = message.replace(/\n/g, '<br>');
        notificationModal.classList.remove('hidden');
        notificationModal.classList.add('flex');
    }
    closeNotificationBtn.addEventListener('click', () => {
        notificationModal.classList.add('hidden');
        notificationModal.classList.remove('flex');
    });

    const generateStoryBtn = document.getElementById('generate-story-btn');
    async function callGeminiAPI(prompt, buttonElement) {
        // PENTING: Ganti teks di bawah ini dengan API Key Anda dari Google AI Studio.
        const apiKey = "AIzaSyDIYJFe9Vz7skEB9yvmNj9inmwAIqLpuVk";
        if (apiKey === "AIzaSyDIYJFe9Vz7skEB9yvmNj9inmwAIqLpuVk") {
            showNotification("Fitur ini membutuhkan API Key. Silakan masukkan kunci API Anda di dalam kode file galeri.html.", "Konfigurasi Diperlukan");
            return;
        }

        buttonElement.classList.add('loading');
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        const payload = { contents: [{ parts: [{ text: prompt }] }] };

        try {
            const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
            if (text) {
                showNotification(text, "Kisah Kita");
            } else {
                throw new Error("Respons API tidak valid.");
            }
        } catch (error) {
            console.error("Gemini API call error:", error);
            showNotification("Sepertinya koneksi ke dunia sihir terputus. Coba lagi nanti atau periksa konsol untuk detail.");
        } finally {
            buttonElement.classList.remove('loading');
        }
    }

    generateStoryBtn.addEventListener('click', async () => {
        const memories = Array.from(document.querySelectorAll('#gallery-grid img')).map(img => img.alt).filter(alt => alt);
        if (memories.length === 0) {
            showNotification("Tambahkan deskripsi pada foto kenangan terlebih dahulu!");
            return;
        }
        const prompt = `Tulis sebuah cerita pendek yang hangat dan romantis dalam Bahasa Indonesia, merangkai kenangan-kenangan berikut menjadi satu narasi perjalanan cinta:\n\n${memories.map(m => `- ${m}`).join('\n')}\n\nPastikan ceritanya mengalir dengan indah dan menyentuh hati.`;
        callGeminiAPI(prompt, generateStoryBtn);
    });
});
</script>

</body>
</html>

