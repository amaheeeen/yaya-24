<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Janji Kita - Sebuah Kejutan Untukmu</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M20,80 h60 v-15 h-60 z' fill='%23E6A4B4'/><path d='M25,65 h50 v-15 h-50 z' fill='%23F3D7CA'/><path d='M30,50 h40 v-15 h-40 z' fill='%23E6A4B4'/><path d='M47,35 h6 v10 h-6 z' fill='white'/><path d='M48,25 a3,5 0 1,0 4,0 l-2,-10 z' fill='orange'/></svg>">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FFF8F0;
            --text-color: #4A4A4A;
            --primary-color: #E6A4B4;
            --secondary-color: #F3D7CA;
            --accent-color: #C17C74;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .nav-link.active {
            color: var(--primary-color);
            font-weight: 700;
        }
        .gemini-btn .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .gemini-btn.loading .spinner { display: block; }
        .gemini-btn.loading .btn-text { display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #promise-result {
             animation: fadeIn 0.5s ease-in-out;
        }
         @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <header id="navbar" class="bg-white/70 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-3">
            <nav class="flex justify-center items-center space-x-4 md:space-x-8">
                <a href="index.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">Let's Celebrate</a>
                <a href="jejak-cerita.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">Jejak Cerita Kita</a>
                <a href="challenge.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">Challenge</a>
                <a href="janji-kita.html" class="nav-link active text-sm md:text-base font-semibold hover:text-pink-500 transition-colors">Janji Kita</a>
                <a href="for-me.html" class="nav-link text-sm md:text-base font-semibold text-gray-600 hover:text-pink-500 transition-colors">For Me</a>
            </nav>
        </div>
    </header>

    <main class="min-h-[80vh] flex flex-col items-center justify-center text-center p-6">
        <section id="promise-generator">
            <h2 class="text-4xl font-bold text-gray-800">Satu Janji Untuk Hari Ini</h2>
            <p class="text-gray-600 mt-4 max-w-lg">Setiap hari adalah petualangan baru. Mari kita ciptakan satu janji kecil untuk membuat hari ini lebih spesial.</p>
            <button id="generate-promise-btn" class="gemini-btn mt-8 bg-pink-500 text-white font-bold py-3 px-8 rounded-full hover:bg-pink-600 transition-colors shadow-lg text-lg flex items-center justify-center mx-auto" style="min-width: 250px; min-height: 56px;">
                <span class="btn-text">âœ¨ Ciptakan Janji Kita</span>
                <div class="spinner"></div>
            </button>
            <div id="promise-result" class="mt-8 p-6 bg-white/50 rounded-lg max-w-2xl text-accent-color text-center text-xl italic hidden shadow"></div>
        </section>
    </main>
    
    <div id="notification-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 text-center max-w-sm mx-auto"><h3 id="notification-title" class="text-xl font-bold mb-4 text-gray-800">Notifikasi</h3><div id="notification-message" class="text-base mb-6 text-left text-gray-600"></div><button id="close-notification" class="bg-pink-500 text-white font-bold py-2 px-6 rounded-full hover:bg-pink-600 transition-colors">Mengerti</button></div>
    </div>

    <div class="fixed bottom-4 right-4 z-40">
        <audio id="background-music" src="assets/audio/hbdsong.mp3" loop></audio>
        <button id="music-control" class="w-12 h-12 bg-white/80 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg text-pink-500 hover:text-pink-700 transition-colors"><svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></button>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const music = document.getElementById('background-music');
    const musicControl = document.getElementById('music-control');
    const playIcon = document.getElementById('play-icon');
    const pauseIcon = document.getElementById('pause-icon');
    let hasInteracted = false;
    
    function playMusic() {
        music.play().then(() => {
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        }).catch(error => console.log("Autoplay ditolak."));
    }

    document.body.addEventListener('click', () => {
        if (!hasInteracted) {
            playMusic();
            hasInteracted = true;
        }
    }, { once: true });
    
    musicControl.addEventListener('click', () => { music.paused ? playMusic() : (music.pause(), playIcon.classList.remove('hidden'), pauseIcon.classList.add('hidden')); });

    // --- Gemini API Logic ---
    const generatePromiseBtn = document.getElementById('generate-promise-btn');
    const promiseResultContainer = document.getElementById('promise-result');
    const notificationModal = document.getElementById('notification-modal');
    const notificationTitle = document.getElementById('notification-title');
    const notificationMessage = document.getElementById('notification-message');
    const closeNotificationBtn = document.getElementById('close-notification');

    function showNotification(message, title) {
        notificationTitle.textContent = title;
        notificationMessage.innerHTML = message;
        notificationModal.classList.remove('hidden');
        notificationModal.classList.add('flex');
    }
    closeNotificationBtn.addEventListener('click', () => {
        notificationModal.classList.add('hidden');
        notificationModal.classList.remove('flex');
    });

    async function callGeminiAPI(prompt, buttonElement) {
        // PENTING: Ganti dengan API Key Anda dari Google AI Studio.
        const apiKey = "AIzaSyDIYJFe9Vz7skEB9yvmNj9inmwAIqLpuVk"; 
        
        if (apiKey === "MASUKKAN_API_KEY_ANDA_DI_SINI") {
            showNotification("Fitur ini membutuhkan API Key.", "Konfigurasi Diperlukan");
            return null;
        }

        if(buttonElement) buttonElement.classList.add('loading');
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        
        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            if (!response.ok) throw new Error("API request failed");
            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
            return text || "Maaf, sihirnya sedang istirahat. Coba lagi.";
        } catch (error) {
            console.error("Gemini API Error:", error);
            showNotification("Koneksi ke dunia sihir terputus. Coba lagi nanti.", "Error");
            return null;
        } finally {
            if(buttonElement) buttonElement.classList.remove('loading');
        }
    }

    generatePromiseBtn.addEventListener('click', async () => {
        const prompt = "Buat sebuah 'janji' yang singkat (satu kalimat), manis, dan lucu untuk pasangan kekasih. Contoh: 'Aku berjanji akan selalu membiarkanmu mengambil gigitan pertama dari makanan penutup kita.' atau 'Aku berjanji cintaku padamu akan lebih awet dari baterai ponsel kita. anda tidak perlu memberikan respon pada awal jawaban anda, langsung buat janji nya. Jangan buat janji yang terlalu panjang, cukup satu kalimat saja.'";
        
        promiseResultContainer.classList.add('hidden');
        const generatedPromise = await callGeminiAPI(prompt, generatePromiseBtn);
        if (generatedPromise) {
            promiseResultContainer.textContent = `"${generatedPromise}"`;
            promiseResultContainer.classList.remove('hidden');
        }
    });
});
</script>

</body>
</html>
